# python 3.9 and virtual envs
$ apt install software-properties-common
$ apt install python3.9
$ apt-get install python3.9-distutils
$ apt install python3.9-dev
$ apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev \
 libnss3-dev libssl-dev libreadline-dev libffi-dev libsqlite3-dev \
 wget libbz2-dev -y
$ virtualenv forecastalert-env --python=/usr/bin/python3.9
$ source forecastalert-env/bin/activate -> source aktive edilir.
$ pip install -r requirements.txt -> bağımlılıklar kurulur.

# user add
$ useradd -s /usr/sbin/nologin -m -d /opt/forecastalert -c 'forecastalert user' forecastalert
$ passwd -l forecastalert

# gunicorn
$ sudo vi /etc/systemd/system/gunicorn.service

	[Unit]
	Description=gunicorn daemon
	After=network.target

	[Service]
	User=forecastalert
	Group=forecastalert
	WorkingDirectory=/opt/forecastalert/djangoProject/DjangoBot/FaceData
	ExecStart=/opt/forecastalert/forecastalert-env/bin/gunicorn --workers 5 --bind unix:/opt/forecastalert/djangoProject/DjangoBot/FaceData/FaceData.sock FaceData.wsgi:application

	[Install]
	WantedBy=multi-user.target

$ sudo systemctl start gunicorn
$ sudo systemctl enable gunicorn

# nginx conf
$ sudo vi /etc/nginx/conf.d/forecastalert.conf

server {
    listen 80;
    server_name forecastalert.tezgel.com;

    location = /favicon.ico { access_log off; log_not_found off; }
    location /static {
        root /opt/forecastalert/djangoProject/DjangoBot/FaceData/;
    }

    location /uploads {
        root /opt/forecastalert/djangoProject/DjangoBot/FaceData/;
    }


    location / {
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://unix:/opt/forecastalert/djangoProject/DjangoBot/FaceData/FaceData.sock;
    }
}

# free ssl

$ sudo add-apt-repository ppa:certbot/certbot
$ sudo apt install python-certbot-nginx
$ sudo certbot --nginx -d forecastalert.tezgel.com (3 ayda bir bu komut ssh dan çalıştırılacak. crontab ayarlanablir.)


#kod güncellenince yapılacak işlem
$git pull
$sudo systemctl restart gunicorn
#yapılmalı

# Not
Türkçe karakter kullanırken hata alıdk. ( locale error )
- çözüm: https://linuxpip.org/fix-python-locale-error/
